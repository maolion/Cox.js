/**
 * #${project}
 * ----------------------------------------------------------------------------
 * Cox.js 它是在标准原生 JavaScript 基础之上对 JavaScript 使用的扩展
 *  
 * ####License (授权许可)
 *
 * (The MIT License)
 *
 * Copyright (c) 2012-2013, Cox, 江宜玮 <maolion.j@gmail.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining  
 * a copy of this software and associated documentation files (the  
 * 'Software'), to deal in the Software without restriction, including  
 * without limitation the rights to use, copy, modify, merge, publish,  
 * distribute, sublicense, and/or sell copies of the Software, and to  
 * permit persons to whom the Software is furnished to do so, subject to  
 * the following conditions:  
 *
 * The above copyright notice and this permission notice shall be  
 * included in all copies or substantial portions of the Software.  
 *
 * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND,  
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF  
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  
 * IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY  
 * CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,  
 * TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE  
 * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.  
 *
 * ----------------------------------------------------------------------------
 *
 * -   Date ${MDATE}
 * -   Version ${version} 
 * -   Author ${author}
 *
 */void function(){function K(e,t){var n=function(){var t=v(n.prototype);return e.apply(t,arguments),t},r=null,i=e.toString();return t&&(n.prototype=v(t)),r=n.prototype,r.constructor=n,n.toString=function s(){return i},n}var e=Array.prototype.slice,t=function(){return this}(),n=Object.prototype,r=function(){},i=function(e,t){return e.length>t.length},s=/\n\r|\r\n|\r|\n/g,o=/function\s*(\w+)*\s*(\([^\)]*\))/,u=/\{(\d+)\}/g,a=/\s/,f=1,l=2,c=void 0,h=typeof require=="function"&&global.require!==require,p=typeof window=="object"&&window===t,d={VERSION:"1.0.0"},v=null,m=null,g=null,y=null,b=null,w=null,E=null,S=null,x=null,T=null,N=null,C=null,k=null,L=null,A=null,O=null,M=null,_=null,D=null,P=null,H=null,B=null,j=null,F=null,I=null,q=null,R=null,U=null,z=null,W=null,X=null,V=null,$=null,J=null;v=Object.create||function(){function e(){}return function(n){return e.prototype=n,new e}}(),void function(){var t={Tool:{},DataType:{},ParamTypeModifier:{},Subsidiary:{}},n={};g=function(r,i,s){var o=null;return i=t[i||g.TOOL],r="__Cox_"+r+"__",o=n[r]||(n[r]={}),s.__COX_KEYWORD_NAME__=r,s.__COX_SIGN__=r,o.name=r,o[s.toString()]=s,i[r]=o,s},g.TOOL="Tool",g.DATATYPE="DataType",g.PARAM_TYPE_MODIFIER="ParamTypeModifier",g.SUBSIDIARY="Subsidiary",g.Tool=function(t,n){return g(t,g.TOOL,n)},g.DataType=function(t,n){return g(t,g.DATATYPE,n)},g.ParamTypeModifier=function(t,n){return g(t,g.PARAM_MTYPE_MODIFIER,n)},g.Subsidiary=function(t,n){return g(t,g.SUBSIDIARY,n)},g.__instancelike__=function(r,i){var s=null;if(typeof r!="function"||!r.__COX_KEYWORD_NAME__)return!1;s=n[r.__COX_KEYWORD_NAME__];if(!(s&&r.toString()in s))return!1;if(i){i=t[i];if(!(s.name in i))return!1}return!0}}(),void function(){var n=-[1]&&[]||["toString","toLocalString","valueOf","constructor","propertyIsEnumerable","isPrototypeOf","hasOwnProperty"],r={"\b":"\\b","  ":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","":"\\v",'"':'\\"',"\\":"\\\\"},i=/[\\\"\x00-\x1f]/g;S=g("PlainObject",g.DATATYPE,function(){return{}}),S.__instancelike__=function(e){return e&&e.constructor===Object},T=g("Type",g.DATATYPE,function(){return Function.apply(null,arguments)}),T.__instancelike__=function(e){return!!e&&(typeof e=="function"||typeof e.__instancelike__=="function")},x=g("Null",g.DATATYPE,function(){return null}),x.__instancelike__=function(e){return e===null||e===c},y=g("XObject",g.DATATYPE,K(function(){})),y.create=v,y.forEach=function(e,t,r,i){t=!!t;for(var s in e){if(t&&!e.hasOwnProperty(s))continue;if(r.call(i,e[s],s,e)===!1)break}for(var o=n.length-1,s;o>=0;o--){s=n[o];if(t&&!e.hasOwnProperty(s))continue;if(r.call(i,e[s],s,e)===!1)break}},y.mix=function(t,n,r,i){return t=t||{},r=!!r,i=i===c?n.constructor!=t.constructor:!!i,y.forEach(n,!i,function(e,n){if(r||!(n in t))t[n]=e}),t},y.keys=function(t){var n=[];return y.forEach(t,!0,function(e,t){n.push(t)}),n},w=g("XString",g.DATATYPE,function(){return new String(arguments[0])}),w.trim=function(t){var n=-1,r=t.length;while(a.test(t.charAt(++n)));while(r>n&&a.test(t.charAt(--r)));return t.slice(n,r+1)},w.leftTrim=function(t){var n=-1;while(a.test(t.charAt(++n)));return t.slice(n)},w.rightTrim=function(t){var n=t.length;while(n>0&&a.test(t.charAt(--n)));return t.slice(0,n+1)},w.format=function(n){var r=e.call(arguments,1);return u.lastIndex=0,n.replace(u,function(e,t){return r[t]})},w.quote=function(t){var n=null;return i.lastIndex=0,n=t.replace(i,function(e){var t=r[e];return typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}),'"'+n+'"'},w.startsWith=function(t,n,r){return r=~~r,t.indexOf(n)==r},w.endsWith=function(t,n,r){return r=(~~r||t.length)-n.length,t.lastIndexOf(n)==r},w.__instancelike__=function(e){return e instanceof String||typeof e=="string"},E=g("XList",g.DATATYPE,function(){return Array.apply(null,arguments)}),E.forEach=function(t,n,r){for(var i=0,s=t.length;i<s;i++){var o=n.call(r,t[i],i,t);if(o===!1)break;typeof o=="number"&&(i=~~o)}},E.indexOf=function(t,n){var r=-1;for(var i=0,s=t.length;i<s;i++)if(t[i]===n){r=i;break}return r},E.lastIndexOf=function(t,n){for(var r=t.length,i=r-1;i>=0;i--)if(t[i]===n)return i;return-1},E.unique=function(t){var n=[],r=0;e:for(var i=0,s=t.length;i<s;i++){var o=t[i];for(var u=0;u<r;u++)if(o===n[u])continue e;n[r++]=o}return n},E.xUnique=function(t){var n={},r=[],i=0;for(var s=0,o=t.length;s<o;s++){var u=t[s];n[u]!==1&&(r[i++]=u,n[u]=1)}return r},E.map=function(t,n,r){var i=[];for(var s=0,o=t.length;s<o;s++)i[s]=n.call(r,t[s],s,t);return i},E.filter=function(t,n,r){var i=[];for(var s=0,o=t.length;s<o;s++)n.call(r,t[s],s,t)&&i.push(t[s]);return i},E.reduce=function(t,n,r,i){var s=0,o=t.length;if(arguments.length<3){if(o===0)return!1;r=t[s++]}for(;s<o;s++)r=n.call(i,r,t[s],s,t);return r},E.some=function(t,n,r){for(var i=0,s=t.length;i<s;i++)if(n.call(r,t[i],i,t))return!0;return!1},E.every=function(t,n,r){var i=!0;for(var s=0,o=t.length;s<o;s++)if(i=i&&n.call(r,t[s],s,t))break;return i},E.remove=function(t,n){var r=0;for(var i=t.length,s=0;s<i;s++)t[s]!==n&&(t[r++]=t[s]);return t.length=r,t},E.shuffle=function(e){var t=e.slice(),n=e.length;while(n){var r=~~(Math.random()*n);temp=null,temp=t[--n],t[n]=t[r],t[r]=temp}return t},E.__instancelike__=function(e){return e instanceof Array},C=function(n,r,i){if(!n)return!1;i=e.call(arguments).slice(1);if(typeof n.__instancelike__=="function")return n.__instancelike__.apply(n,i);if(r!==null&&r!==c&&n===Object)return!0;switch(typeof r){case"object":case"function":case"undefined":return typeof n=="function"&&r instanceof n;default:return r.constructor===n}}}(),void function(){var n=null,i=null;n={toString:function s(){return this.__COX_SIGN__},equals:function(t){return t===this}},k=g("Nullable",g.PARAM_TYPE_MODIFIER,K(function(t){if(!C(T,t))throw new TypeError("Nullable操作符需要一个Function类型实例.");this.type=t,this.__COX_SIGN__="Nullable( "+(t.__COX_SIGN__||t.name||t.toString())+" )"},n)),k.prototype.__instancelike__=function(e){return e===null||e===c||C(this.type,e)},L=g("Optional",g.PARAM_TYPE_MODIFIER,K(function(t,n){if(!C(T,t))throw new TypeError("Optional操作符需要一个Function类型实例.");if(arguments.length===1)switch(t){case Number:n=0;break;case String:n="";break;case Boolean:n=!1;break;case Object:n={};break;case Array:n=[];break;default:n=null}else if(!C(t,n)&&!C(x,n))throw new TypeError("Optional操作符中 value参数（如果给定)的值类型必须与type参数的类型匹配.");this.type=t,this.value=n,this.__COX_SIGN__="Optional( "+((t.name||t.__COX_SIGN__||t.toString())+" )")},n)),A=g("Params",g.PARAM_TYPE_MODIFIER,K(function(t){if(!C(T,t))throw new TypeError("Params操作符需要一个Function类型实例.");this.type=t,this.__COX_SIGN__="Params( "+(t.__COX_SIGN__||t.name||t.toString())+" )"},n)),A.prototype.__instancelike__=function(e){if(!!e&&e instanceof Array){for(var t=0,n=~~e.length;t<n;t++)if(!C(this.type,e[t]))return!1;return!0}return!1},O=g("ParamTypeTable",g.SUBSIDIARY,K(function(){var t=arguments.length;this.minParamCount=0,this.maxParamCount=0,this.optStartIndex=-1,this.optEndIndex=0;for(var n=0,r=t-1;n<=r;n++){var i=arguments[n];if(i instanceof k||i instanceof A&&n===r||C(T,i)){this.minParamCount++,this.maxParamCount++;continue}if(i instanceof L){this.maxParamCount++;continue}throw new SynataxError("无效的参数类型列表定义")}arguments[t-1]instanceof A&&(this.minParamCount--,this.maxParamCount=Infinity),this.length=t,this.__types=e.call(arguments),this.__COX_SIGN__=E.map(arguments,function(e){return e.name||e.toString()}).join(", ")})),O.prototype.parse=function(t){var t=t.slice(),n=t.length,r=this.__types.slice(),i=null,s=[];if(n<this.minParamCount||n>this.maxParamCount)return null;while(i=r.shift())if(i instanceof A){if(!C(i,t))return null;s.push(t)}else{if(i instanceof L){var o=O.apply(null,r),u=null,a=null;t.length&&C(i.type,t[0])&&(a=t[0],u=o.parse(t.slice(1))),u||(a=i.value,u=o.parse(t)),u?(s.push(a),s.push.apply(s,u)):s=null;break}if(!C(i,t[0]))return null;s.push(t.shift())}return s},O.prototype.equals=function(){var t=arguments[0],n=arguments.length;if(n===1&&t instanceof O){if(t===this)return!0;if(t.length!==this.length||t.minParamCount!==this.minParamCount||t.maxParamCount!==this.maxParamCount)return!1;t=t.__types,n=t.length}else{t=arguments;if(n!==this.length)return!1}for(var r=0;r<n;r++){var i=t[r];switch(i.constructor){case L:case k:case A:if(this.__types[r].constructor!==i.constructor||this.__types[r].type!==i.type)return!1;break;default:if(i!==this.__types[r])return!1}}return!0},O.prototype.toString=function o(){return this.__COX_SIGN__},i={define:function(){var n=e.call(arguments),r=O.apply(null,n.slice(0,-1)),i=n[n.length-1],s=this.__COX_XFUNCTION_OVERLOAD_LIST__,o=s.length,u=s.length;if(typeof i!="function")throw new TypeError("需要为重载提供一个能被执行的处理程序");for(var a=0;a<o;a++)if(s[a].equals(r)){u=a;break}s[u]=r,r.__COX_BUILD_HANDLER__=i,this.__COX_SIGN__=[];for(var a=0,f=s.length,l=this.__COX_XFUNCTION_NAME__;a<f;a++)this.__COX_SIGN__.push(l+"("+s[a]+")");this.__COX_SIGN__=this.__COX_SIGN__.join("\n")},defined:function(){var n=this.__COX_XFUNCTION_OVERLOAD_LIST__,r=n.length,i=e.call(arguments);for(var s=0;s<r;s++)if(n[s].equals.apply(n[s],i))return!0;return!1},clone:function(){var t=b(r);return t.__COX_XFUNCTION_OVERLOAD_LIST__=this.__COX_XFUNCTION_OVERLOAD_LIST__.slice(),t.__COX_XFUNCTION_NAME__=this.__COX_XFUNCTION_NAME__,t.__COX_SIGN__=this.__COX_SIGN__,t},toString:function u(){return this.__COX_SIGN__}},b=g("XFunction",g.DATATYPE,function(){var n=function(){var t=e.call(arguments),r=n.__COX_XFUNCTION_OVERLOAD_LIST__,i=null,s=null;for(var o=0,u=r.length;o<u;o++){var a=r[o];if(s=a.parse(t)){i=a.__COX_BUILD_HANDLER__;break}}if(!i)throw new Error("未定义与当前传送参数相匹配的处理程序");return i.apply(this,s)};return n.__COX_XFUNCTION_OVERLOAD_LIST__=[],n.__COX_XFUNCTION_NAME__=n.__COX_SIGN__=arguments[arguments.length-1].name||"",y.mix(n,i,!0),n.define.apply(n,arguments),n}),b.bind=function(n,r,i){return i=e.call(arguments).slice(2),function(){return n.apply(r,i.concat.apply(i,arguments))}},b.memoize=function a(t){var a={};return function(){var n=e.call(arguments),r=JSON.stringify(n);return a.hasOwnProperty(r)?a[r]:a[r]=t.apply(this,arguments)}}}(),void function(){var n=null,i=null;_=g("Extends",g.SUBSIDIARY,K(function(){this.parents=E.unique(e.call(arguments))})),M=g("Implements",g.SUBSIDIARY,K(function(){var n=E.unique(e.call(arguments)),r=n.length;for(var i=0;i<r;i++)if(!(n[i]instanceof D))throw new TypeError("无效的接口类型");this.interfaces=n})),D=g("Interface",g.DATATYPE,K(function(t,n,r){var i={},s={},o=[i,s];if(n){for(var u=0,a=n.parents.length;u<a;u++)if(!(n.parents[u]instanceof D))throw new TypeError("接口类只允许扩展由Interface操作符创建的接口类");n=n.parents}if(r&&typeof r!="function")throw new TypeError("接口类只允许使用Function类型的实例作为接口类的类体（提供公共接口的定义）");this.__COX_INTERFACE_EXTENDS__=n||null,this.__COX_INTERFACE_CMETHODS__=i,this.__COX_INTERFACE_IMETHODS__=s,this.__COX_INTERFACE_NAME__=t=t||"anonymous",this.__COX_SIGN__="[Interface "+t+"]",i.prototype={},r.call(i,i,s),delete i.constructor,y.mix(s,i.prototype,!0),delete i.prototype;for(var u=0,a=o.length;u<a;u++){var f=o[u];y.forEach(f,!0,function(e,t){if(e===Function)return;if(e instanceof O){f[t]=[e];return}if(e instanceof Array)for(var n=0,r=e.length;n<r;n++)if(!(e instanceof O))return;throw new TypeError("无效的接口定义")})}})),D.prototype.extended=function(e){var t=this.__COX_INTERFACE_EXTENDS__;if(!!t&&e instanceof D){if(E.indexOf(t,e)!==-1)return!0;for(var n=0,r=t.length;n<r;n++)if(t[n].extended(e))return ret=!0,!0;return!1}return!1},D.prototype.implementIn=function(e){var t=this,n=this.__COX_INTERFACE_EXTENDS__,r=this.__IGNORES__ instanceof Array?this.__IGNORES__:[],i=typeof e=="function"?e:e.constructor,s=[{methods:this.__COX_INTERFACE_CMETHODS__,obj:i},{methods:this.__COX_INTERFACE_IMETHODS__,obj:typeof e=="function"?e.prototype:e}];if(E.indexOf(r,this)!==-1)return!0;r.push(this);if(n)for(var o=0,u=n.length;o<u;o++){var a=n[o];a.__IGNORES__=r,a.implementIn(e),delete a.__IGNORES__}while(e=s.shift())y.forEach(e.methods,!0,function(n,r){var s=e.obj[r];if(!(r in e.obj))throw new Error(t+"接口类中的`"+r+"`接口未被实现");typeof e.obj!="function"&&r==="constructor"&&i.__COX_CLASS_CLASSINFO__&&(s=i.__COX_CLASS_CLASSINFO__.CONSTRUCTOR);if(n===Function&&typeof s!="function")throw new TypeError(t+"接口类中的`"+r+"`接口以非Function类型实例被实现");if(n instanceof Array)for(var o=0,u=n.length;o<u;o++)if(typeof s!="function"||typeof s.defined!="function"||!s.defined(n[o]))throw new TypeError(t+"接口类中的`"+r+"`接口未被正确实现")});return!0},D.prototype.__instancelike__=function(e){if(!e||typeof e!="object")return!1;try{return this.implementIn(e),!0}catch(t){return!1}},D.prototype.toString=function s(){return this.__COX_SIGN__},P=g("ClassMode",g.SUBSIDIARY,K(function(t){this.__COX_CLASS_MODE_NAME__=t})),P.prototype.toString=function o(){return this.__COX_CLASS_MODE_NAME__},P.prototype.newClass=r,P.prototype.prefect=r,B=P("Abstract"),B.newClass=function(){return function(){throw new SynataxError("抽象类不允许被实例化！")}},B.implementIn=function(t,n){var r=t.__COX_CLASS_CLASSINFO__,i=t,s=typeof n=="function"?n:n.constructor,o=[{methods:r.CLASS_METHODS,obj:s},{methods:r.INSTANCE_METHODS,obj:typeof n=="function"?n.prototype:n}];while(n=o.shift())y.forEach(n.methods,!0,function(e,t){var r=n.obj[t];if(!(t in n.obj))throw new Error(i+"抽象类中的`"+t+"`接口未被实现");typeof n.obj!="function"&&t==="constructor"&&s.__COX_CLASS_CLASSINFO__&&(r=s.__COX_CLASS_CLASSINFO__.CONSTRUCTOR);if(e===Function&&typeof r!="function")throw new TypeError(i+"抽象类中的`"+t+"`接口以非Function类型实例被实现");if(e instanceof Array)for(var o=0,u=e.length;o<u;o++)if(typeof r!="function"||typeof r.defined!="function"||!r.defined(e[o]))throw new TypeError(i+"抽象类中的`"+t+"`接口未被正确实现")});return!0},B.perfect=function(t){var r=t.CLASS,i=r.prototype,s=i.constructor,o=null,u={},a={},f=[{source:r,dest:u},{source:i,dest:a}];delete u.constructor;for(var l=0,c=f.length;l<c;l++){var h=f[l].source,p=f[l].dest;y.forEach(h,!0,function(e,t){if(e===Function)p[t]=e,delete h[t];else if(e instanceof O)p[t]=[e],delete h[t];else if(e instanceof Array){for(var n=0,r=e.length;n<r;n++)if(!(e[n]instanceof O))return;p[t]=e,delete h[t]}})}t.CLASS_METHODS=u,t.INSTANCE_METHODS=a;if(s!==r&&a.constructor!==s&&!(s instanceof O)){if(typeof s!="function")throw new TypeError("无效的构造函数定义");t.CONSTRUCTOR=s}o=r.toString,y.mix(r,n,!0),delete r.__COX_KEYWORD_NAME__,r.__COX_SIGN__="[Abstract Class "+t.NAME+"]",r.__COX_CLASS_CLASSINFO__=t,o!==n.toString&&(r.toString=o),delete r.constructor,r.implementIn=function(e){return B.implementIn(r,e)},r.prototype=i},j=P("Single"),j.newClass=function(t){return function(){return j.getInstance.apply(t.CLASS,arguments)}},j.getInstance=function(){var t=this.__COX_CLASS_CLASSINFO__;return t.SINGLE_INSTANCE instanceof this?t.SINGLE_INSTANCE:(t.CONSTRUCTOR.apply(t.SINGLE_INSTANCE=v(this.prototype),arguments),t.SINGLE_INSTANCE)},F=P("Finaly"),F.newClass=function(t){return function(){if(!(this.constructor===t.CLASS&&this instanceof t.CLASS))throw new Error(t.__CLASS__+"类不能在当前情况情况下进行实例化");t.CONSTRUCTOR.apply(this,arguments)}},H=P("Entity"),H.newClass=function(t){return function(){t.CONSTRUCTOR.apply(this,arguments)}},j.perfect=F.perfect=H.perfect=function(t){var r=t.CLASS,i=r.prototype,s=i.constructor,o=t.SUPER,u=o&&o.__COX_CLASS_CLASSINFO__,a=null;a=r.toString,y.mix(r,n,!0),t.MODE===j&&(r.getInstance=j.getInstance),a!==n.toString&&(r.toString=a),a=i.toString,y.mix(i,n.prototype,!0),delete r.__COX_KEYWORD_NAME__,t.SUPER&&r.implementIn===t.SUPER.implementIn&&delete r.implementIn,r.__COX_SIGN__="["+(t.MODE===H?"":t.MODE.__COX_CLASS_MODE_NAME__+" ")+"Class "+t.NAME+"]",r.__COX_CLASS_CLASSINFO__=t,a!==n.prototype.toString&&(i.toString=a),i.constructor=s;if(s!==r){if(s===Function||typeof s!="function")throw new TypeError("在类定义中为类实例提供的constructor成员只允许赋值为 Function类型实例");t.CONSTRUCTOR=s}for(var f=0,l=t.IMPLEMENTS.length;f<l;f++)t.IMPLEMENTS[f].implementIn(r);r.prototype=i},n=g("BaseClass",g.DATATYPE,K(r,y.prototype)),n.__COX_SIGN__="[Class BaseClass]",n.__COX_CLASS_CLASSINFO__={NAME:"BaseClass",MODE:H,SUPER:null,IMPLEMENTS:null,CLASS:n,CONSTRUCTOR:n,SINGLE_INSTANCE:null},n.implemented=function(t){var n=this.__COX_CLASS_CLASSINFO__;if(E.indexOf(n.IMPLEMENTS,t)!==-1)return!0;for(var r=0,i=n.IMPLEMENTS.length;r<i;r++)if(n.IMPLEMENTS[r].extended(t))return!0;return!1},n.extended=function(t){return this.prototype instanceof t},n.toString=function u(){return this.__COX_SIGN__},n.prototype.Super=function(t,n){var n=e.call(arguments,1),r=this.constructor.__COX_CLASS_CLASSINFO__,i=null,s=null,o=null,u=null;if(typeof t=="string"||t instanceof String){t=t==="constructor"||!t?"CONSTRUCTOR":t,this.__COX_CSLEVEL__||(this.__COX_CSLEVEL__=r.SUPER),i=this.__COX_CSLEVEL__,s=i.__COX_CLASS_CLASSINFO__;if(i){if(t==="CONSTRUCTOR"&&s)u=s[t];else{if(!(t in i.prototype))throw new Error("在 "+i+"类 中没有定义 `"+t+"`成员");u=i.prototype[t]}typeof u=="function"?(this.__COX_CSLEVEL__=s&&s.SUPER||null,o=u.apply(this,n)):(obj&&n.length&&(obj[t]=n[0]),o=obj[t])}return delete this.__COX_CSLEVEL__,o}throw new TypeError("类实例 Super( key, args )方法的 key参数项只接受 String类型实例")},n.prototype.instanceOf=function(e){return e instanceof D?this.constructor.implemented(e):this instanceof e},n.prototype.toString=function a(){return this.__COX_SIGN__},I=g("Class",g.DATATYPE,function(t,r,i,s,o){var u=null,a=null,t=t||o.name,i=i&&i.parents||[n],f=null,l={NAME:t,MODE:r,SUPER:null,IMPLEMENTS:null,CLASS:null,CONSTRUCTOR:null,SINGLE_INSTANCE:null};u=l.CLASS=r.newClass(l);if(i.length>1)throw new SynataxError("类不允许扩展多个父类");i=i[0]||n;if(typeof i!="function")throw new TypeError("无效的扩展类");f=i.__COX_CLASS_CLASSINFO__;if(f&&f.MODE===F)throw new Error(i+"类不允许被扩展");return f&&typeof f.CONSTRUCTOR=="function"&&(a=f.CONSTRUCTOR,typeof a.clone=="function"&&(a=a.clone())),y.forEach(i,!0,function(e,t){e&&typeof e.clone=="function"?u[t]=e.clone():u[t]=e}),u.prototype=v(i.prototype),y.forEach(i.prototype,!0,function(e,t){e&&typeof e.clone=="function"&&(u.prototype[t]=e.clone())}),s=s&&s.interfaces||[],u.prototype.constructor=a,o.call(u,u,u.prototype),delete u.constructor,l.IMPLEMENTS=E.xUnique(s.concat(f&&f.IMPLEMENTS||[])),f.MODE===B&&l.IMPLEMENTS.push(i),l.SUPER=i,l.CONSTRUCTOR=a,r.perfect(l),u.prototype.constructor=u,u.prototype.__COX_SIGN__="[Object "+t+"]",u})}(),void function(){var t=0,n=1,r=-1,i=-2,s=null;s=D("IEvent",null,function(e,t){t.constructor=[O(String,L(Object))],t.stopPropagation=Function}),I("EvnetListeners",H,null,null,function(e,t){R=this,t.constructor=function(e,t){this._relate_event_type=e,this._target=t,this._handlers=[],this._processing=[]},t.notify=function(e,t){var n=null;this._processing=this._handlers.slice();while(n=this._processing.shift())n.apply(t,e)},t.add=function(e){this._handlers.push(e)},t.remove=function(e){if(!e)this._handlers.length=0,this._processing.length=0;else{var t=this._handlers,n=0;for(var r=0,i=t.length;r<i;r++)t[r]!==e&&(t[n++]=t[r]);t.length=n,this._processing.length&&(this._processing=t)}},t.break=function(){this._processing.length=0}}),I("Event",H,null,M(s),function(e,t){q=this,t.constructor=b(String,L(Object,{}),function(e,t){y.mix(this,t,!0),this.name=e,this.listener=new R(e,this)}),t.stopPropagation=function(){this.listener.break()}}),I("EventSource",H,null,null,function(e,t){U=this,t.constructor=function(){this._events={}},t.dispatchEvent=b(A(q),function(e){var t=this._events,n=this;for(var r=0,i=e.length;r<i;r++){var s=e[r];t[s.name]=s}}),t.fireEvent=b(String,L(Array,null),L(Object,null),function(e,t,n){var r=this._events[e];r instanceof q&&r.listener.notify(t||[],n||this)}),t.addEventListener=b(Function,function(e){y.forEach(this._events,!0,function(t,n){t instanceof q&&t.listener.add(e)})}),t.addEventListener.define(String,Function,function(e,t){var n=this._events[e];n instanceof q&&n.listener.add(t)}),t.addOnceEventListener=function(e,t){var n=this;this.addEventListener(e,function(){t.apply(this,arguments),n._events[e].listener.remove(arguments.callee)})},t.removeEventListener=b(L(String),L(Function),function(e,t){if(e=="")y.forEach(this._events,!0,function(e){e instanceof q&&e.listener.remove(t)});else{var n=this._events[e];n instanceof q&&n.listener.remove(t)}}),t.getEvent=function(e){var t=this._events[e];return t instanceof q?t:null},t.on=t.addEventListener,t.once=t.addOnceEventListener,t.un=t.removeEventListener}),I("Deferred",H,_(U),null,function(e,s){z=this,e.DSTATE_UNFULFILLED=t,e.DSTATE_FULFILLED=n,e.DSTATE_REJECTED=r,e.DSTATE_ERROR=i,s.constructor=function(){var e=this;this.Super("constructor"),this._state=t,this._value=null,this._error=null,this.dispatchEvent(new q("stateChange",{target:this}),new q("resolved",{target:this}),new q("rejected",{target:this}),new q("done",{target:this})),this.__COX_DEFERRED_ERROR__=function(t){var n=new Error(t);e._state=i,e._error=n,e.fireEvent("stateChange",[i]),e.fireEvent("rejected",[e._value,n]),e.fireEvent("done",[!1,e._value,n]),e.getEvent("resolved").stopPropagation()}},s.then=b(Function,L(Function),function(e,s){switch(this._state){case t:this.addOnceEventListener("resolved",e),s&&this.addOnceEventListener("rejected",s);break;case n:e.call(this,this._value,this.__COX_DEFERRED_ERROR__);break;case i:case r:s&&s.call(this,this._value,this._error)}}),s.done=b(Function,function(e){this._state===t?this.addOnceEventListener("done",e):e.call(this,this._state===n,this._value,this._error)}),s.resolved=function(e){var r=this;if(this._state!==t)throw new Error("非法操作:");this._state=n,this._value=e,this.fireEvent("stateChange",[n]),this.fireEvent("resolved",[e,this.__COX_DEFERRED_ERROR__,function(){r.getEvent("resolved").stopPropagation()}]),!this._error&&this.fireEvent("done",[!0,e])},s.rejected=function(e){if(this._state!==t)throw e instanceof Error?e:new Error("非法操作");this._state=r,this._value=e,this.fireEvent("stateChange",[r]),this.fireEvent("rejected",[e]),this.fireEvent("done",[!1,e])},s.getValue=function(){return this._value},s.isDone=function(){return this._state!==t},s.isResolved=function(){return this._state===n},s.isRejected=function(){return this._state===r}}),I("DeferredList",H,_(z),null,function(e,i){function s(e){function i(){e.splice(E.indexOf(this),1),this.isResolved()?t._resolved_list.push(this):t._rejected_list.push(this),e.length===0&&(t._rejected_list.length===0?(t._state=n,t.getValue(),t.fireEvent("stateChange",[n]),t.fireEvent("resolved",[t._value,t.__COX_DEFERRED_ERROR__,function(){t.getEvent("resolved").stopPropagation()}]),!t._error&&t.fireEvent("done",[!0,t._value])):(t._state=r,t.getValue(),t.fireEvent("stateChange",[r]),t.fireEvent("rejected",[t._value]),t.fireEvent("done",[!1,t._value])))}var t=this,e=e.slice();if(e.length===0)throw new Error("DeferredList类构造器参数列表中至少需要一个参数.");this.Super("constructor"),this._deferred_list=e.slice(),this._resolved_list=[],this._rejected_list=[],E.forEach(this._deferred_list,function(e,t){e.done(i)})}W=this,i.constructor=b(A(z),s),i.constructor.define(Array,s),i.resolved=function(e){var n=this,r=this._deferred_list;if(this._state!==t)throw new Error("DeferredList类实例的resolved方法，只能在DeferredList 类实例的状态在未完成时才能被调用.");for(var i=0,s=r.length;i<s;i++){var o=r[i];o.isDone()||o.resolved(e)}},i.rejected=function(e){var n=this._deferred_list;if(this._state!==t)throw new Error("DeferredList类实例的rejected方法，只能在DeferredList 类实例的状态在未完成时才能被调用.");for(var r=0,i=n.length;r<i;r++){var s=n[r];s.isDone()||s.rejected(e)}},i.getValue=function(){return this.isDone()?this._value=this._value||E.map(this._deferred_list,function(e,t){return e.getValue()}):null},i.getDeferredList=function(){return this._deferred_list}})}(),void function(){function L(e){var t=0;root=e.charAt(0)==="/"?"/":"",e=D(e),e=e.split("/");for(var n=0,r=e.length;n<r;n++){var i=e[n];switch(i){case"":case".":break;case"..":t>0&&t--;break;default:e[t++]=i}}return e.length=t,e.unshift(""),root+e.join("/")}function A(e){var t;return e=D(e),e=e.charAt(e.length-1)==="/"?e.slice(0,-1):e,t=e.lastIndexOf("/"),t>-1&&(e=e.slice(t+1)),e}function O(e){var t;return e=D(e),t=e.lastIndexOf("/"),t!==-1?e=e.slice(0,t)||"/":e="",e}function M(e){var t=e.match(r);return t=t&&t[0]||"",[t,e.replace(t,"")]}function D(e){return a.lastIndex=0,e.replace(a,"/")}function P(e){var t=e.depend,n=t&&t.modules||{},r=O(e.url||""),i={};return function(s){var o=i[s],u=null;o instanceof S||y.forEach(n,!0,function(e,t){var n=e.url||e.id;if(t===s||n.slice(0-s.length)===s||n.slice(0-s.length-3)===s+".js"||L(n)===L(r+"/"+s))return o=i[s]=e,!1});if(o instanceof S){if(!o.isResolved()&&o.isRejected())throw new Error(s+" 模块由于未被准备好或该模块是一个不可用模块，导致无法被正常使用.");return o.exports||(o.exports={}),typeof o.define!="function"?o.exports:(u=o.define,delete o.define,o.__define=u,u(P(o),o.exports,o,o.url,O(o.url)),o.exports)}throw new Error("请求的 "+s+" 模块未被加载或未在 "+(e.uri||"当前执行")+" 模块的依赖列表中声明.")}}var n=/(?:https?|file):\/{2,3}([^\?#]+).*$/i,r=/^\w+:\/{2,3}/,i=/^(\w+:\/{2,3}[^\/]+)/,s=/(?:\?([^#]*))?(#.*)?$/,o=/^(.*)\/.*$/,u=/^[\w.]+$/,a=/\\{1,}/g,f=null,l=null,c=null,d=null,v=null,m=null,S=null,x=null,T={debug:!1,roots:{}},N=null,k=function(){var e=(new Date).getTime();return function(){return e++}}();if(p)f=t.document.documentElement,l=t.location.href,c=l.match(r)[0],d=l.match(i)[1],m=l.match(o)[1],v=".js";else{if(!h)throw new Error("Cox 未在该环境中提供兼容支持");c="",d=O(require.main.filename),m=d,v=""}T.roots["~/"]=m,T.roots["~/Cox"]=(h?D(__dirname):m)+"/modules",x=I("ModuleCenter",j,_(U),null,function(e,t){function u(e,t){var n=e[t];return n instanceof S?n:null}function a(e,t){var n=null;return y.forEach(e,!0,function(e,r){if(t(e,r))return n=e,!1}),n}var n={},r={},i={},s=h?require.cache:{},o=null;o=[!h&&function(){function i(e){function s(){if(t.addEventListener||t.readyState==="loaded"||t.readyState==="complete")delete r[e.id],n[e.id]=e,e.loaded.isDone()||(e.loaded.resolved(),e.resolved()),t.removeEventListener?(t.removeEventListener("load",s,!1),t.removeEventListener("error",s,!1)):t.detachEvent("onreadystatechange",s)}function o(){delete r[e.id],t.removeEventListener?(t.removeEventListener("load",s,!1),t.removeEventListener("error",o,!1)):(t.detachEvent("onreadystatechange",s),t.detachEvent("error",o)),e.loaded.rejected()}var t=document.createElement("script"),i=e.url;if(!i)return;t.addEventListener?(t.addEventListener("load",s,!1),t.addEventListener("error",o,!1)):t.attachEvent("onreadystatechange",s),t.setAttribute("type","text/javascript"),t.setAttribute("charset","utf-8"),t.setAttribute("async","true"),t.setAttribute("defer","true"),t.setAttribute("src",i),f.firstChild.insertBefore(t,null)}var e=document,t=new z;return e.addEventListener?e.addEventListener("DOMContentLoaded",function(){e.removeEventListener("DOMContentLoaded",arguments.callee,!1),t.resolved()},!1):e.attachEvent("onreadystatechange",function(){/^c/.test(e.readyState)&&(e.detachEvent("onreadystatechange",arguments.callee),t.resolved())}),function(e){t.then(function(){i(e)})}}(),function(e){var t=null;try{t=require(e.url||e.id),n[e.id]=e}catch(i){throw e.loaded.rejected(),e.rejected(),i}finally{delete r[e.id]}e.loaded.isDone()||e.loaded.resolved(),e.isEmpty()&&(e.define=function(e,n,r){r.exports=t},e.resolved())}][~~h],t.constructor=function(){this.Super("constructor"),this.dispatchEvent(new q("loading"),new q("loaded"),new q("error"))},t.pending=function(){function e(t,n,r){var i=n.depend&&n.depend.modules,s=[];i&&y.forEach(i,!0,function(e,n){e=x.getModule(e.id)||e,i[n]=e,n=e.id,n!==t.id&&!(r.list[n]instanceof S)&&(r.list[n]=e,r.length++,s.push(e))}),s.length&&E.forEach(s,function(n){n.loaded.then(function(){r.length--,e(t,n,r)},function(e){t.rejected(e)})});if(r.length===0&&r.wait===null){r.wait=1;if(t.isMain()){var o=[];t.depend&&y.forEach(t.depend.modules,!0,function(e){e instanceof S&&o.push(e)}),(new W(o)).then(function(){t.resolved()},function(e){t.rejected(e)})}else t.resolved()}}return function(t){var n={module:t,list:{},length:0,wait:null},s=x.getEvent("loaded"),u=x.getEvent("loading"),a=x.getEvent("error");i[t.uid]=n,t.done(function(){delete i[t.uid]}),t.depend&&t.depend.modules&&y.forEach(t.depend.modules,!0,function(e,n){x.exists(e)?t.depend.modules[n]=e=x.getModule(e.id):(e.__COX_MODULE_MAIN__=t.__COX_MODULE_MAIN__||t,r[e.id]=e,o(e),u.target=e,x.fireEvent("loading",[u]),e.loaded.then(function(){s.target=e,x.fireEvent("loaded",[s])},function(){a.target=e,x.fireEvent("eerror",[a])}))}),e(t,t,n)}}(),t.exists=function(e){return this.loaded(e)||this.loading(e)},t.loaded=function(e){return e&&n[e.id]instanceof S},t.loading=function(e){return e&&r[e.id]instanceof S},t.getModule=function(e){var t=null;return t=n[e],t=t instanceof S?t:r[e],t instanceof S?t:null},t.findInLoading=b(String,function(e){return u(r,e)}),t.findInLoading.define(Function,function(e){return a(r,e)}),t.findInLoaded=b(String,function(e){return u(n,e)}),t.findInLoaded.define(Function,function(e){return a(n,e)}),t.findInCache=b(String,function(e){return u(s,e)}),t.findInCache.define(Function,function(e){return a(s,e)})}).getInstance(),I("Module",F,_(z),null,function(e,t){function r(e,t){var n=M(e);return e=n[1],n=n[0],n+L(e+"/"+t).slice(1)+v}S=this;var n=[{pattern:/^\w+:\/{2,3}[\S]+$/,resolve:function(e){return e}},{pattern:/^~\/.+$/,resolve:function(e){var t="~/";return E.forEach(e.slice(2).split("/"),function(e,n){if(t+e in T.roots)return t+=e,!1}),r(T.roots[t],e.slice(t.length))}},{pattern:/^(?:\.{1,2}?\/|\/).+$/,resolve:function(e,t){return e.charAt(0)==="/"&&(t=d),r(t,e)}},{pattern:/^[\S]+$/,resolve:function(e,t){return""}},{pattern:/^[A-Za-z]\:.+$/,resolve:function(e){return e}}];h&&(r=function(e,t){return L(e+"/"+t).slice(1)}),e.resolve=function(e,t){var r="",i={};return t=t||m,e&&E.forEach(n,function(n,i){if(n.pattern.test(e)===!0)return r=n.resolve(e,t),!1},this),i.id=r||e,i.url=r,i},t.constructor=function(e,t,n,r){this.Super("constructor"),this.setUri(e,t),this.exports={},this.loaded=new z,this.depend=n,this.define=r,this.uid="MODULE#"+k(),this.__COX_MODULE_MAIN__=null},t.setUri=function(e,t){var n="";e=w.trim(e||""),t=C(String,t)?t:T.roots["~/"],y.mix(this,S.resolve(e,t),!0)},t.isMain=function(){return this===this.__COX_MODULE_MAIN__},t.isEmpty=function(){return!this.depend&&!this.define}}),J=g("Modules",g.SUBSIDIARY,K(function(e){this.setModules(e)})),J.prototype.setModules=function(e,t){var n={};this._uris=e,this._root=t=t||m,E.forEach(e,function(e,r){var i,s;if(n[e]instanceof S)return;i=S.resolve(e,t),s=i.id,n[e]=x.getModule(s)||new S(e,t)}),this.modules=n},J.prototype.setRoot=function(e){this._root=e,this.setModules(this._uris,e)},J.addRoot=function(e,t){n.test(t)===!1&&(t.charAt(0)==="/"?t=d+L(t):t=d+L((m+"/"+t).replace(d,""))),T.roots["~/"+e]=t},J.removeRoot=function(e){e===""?T.roots["~/"]=m:delete T.roots["~/"+e]},J.getRoot=function(e){return T.roots["~/"+(e||"")]||null},J.ModuleCenter=x,X=g("Define",g.TOOL,function(t,n,r){var i=null,t=w.trim(t),s=new RegExp("/"+t+"(?:.js|.JS)?$");if(!(C(String,t)?t:"").length||!u.test(t))throw new Error("无效的模块标识符");if(!r)throw new Error("需要一个Function类型实例来完成模块的定义");i=x.findInLoading(t)||x.findInLoading(function(e,t){return s.test(t)});if(!i){if(h){i=x.findInCache(function(e,t){return s.test(D(t))&&!e.loaded});if(i){var o=O(i.filename);if(n)$(n,o,function(e,t){r(e,t.exports,t),i.exports=t.exports});else{var a=new S(t,o,n,r);a.loaded.resolved(),a.resolved(),a.__COX_MODULE_MAIN__=a,r(P(a),a.exports,a),i.exports=a.exports}return!1}}i=new S(t,"")}n&&n.setRoot(O(i.url)),i.define=r,i.depend=n,i.loaded
.resolved(),x.pending(i)}),$=g("Use",g.TOOL,function(e,t,r){var i=null;return t&&(n.test(t)||(t=L(T.roots["~/"]+"/"+t).substr(1)),e.setRoot(t)),i=new S("","",e),i.then(function(){r(P(i),i)}),i.__COX_MODULE_MAIN__=i,i.loaded.resolved(),x.pending(i),i})}(),t.Cox=d,t.XObject=d.XObject=y,t.XString=d.XString=w,t.XList=d.XList=E,t.is=d.is=C,t.Nullable=d.Nullable=k,t.Optional=d.Optional=L,t.Params=d.Params=A,t.ParamTypeTable=d.ParamTypeTable=O,t.Implements=d.Implements=M,t.Extends=d.Extends=_,t.Abstract=d.Abstract=B,t.Single=d.Single=j,t.Finaly=d.Finaly=F,t.XFunction=d.XFunction=b,t.Deferred=d.Deferred=z,t.DeferredList=d.DeferredList=W,t.forEach=d.forEach=b(Array,Function,L(Object),E.forEach),t.Iterator=d.Iterator=D("Iterator",null,function(e,t){t.hasNext=Function,t.next=Function,t.reset=Function}),t.forEach.define(d.Iterator,Function,L(Object),function(e,t,n){while(e.hasNext())if(t.call(n||null,e.next(),e)===!1)break}),t.forEach.define(Object,L(Boolean,!0),Function,L(Object),y.forEach),t.Class=d.Class=b(L(String),L(P,H),L(_),L(M),Function,I),t.Interface=d.Interface=b(String,L(_),Function,D),t.Define=d.Define=b(String,L(J),Function,X),t.Modules=d.Modules=b(Params(String),J),t.Modules.define(Array,J),t.Depend=d.Modules,t.Use=d.Use=b(J,L(String),Function,$),d.Event=q,d.EventListener=R,d.EventSource=U,d.PlainObject=S,d.ownDocument=t.document,d.ownWindow=t,y.mix(t.Modules,J,!0),typeof exports!="undefined"&&(module.exports=d)}()